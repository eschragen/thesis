library(readxl)
company_info = read_excel("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/company_info/company.xlsx")
View(company_info)
#calculate score
company_info = company_info %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3))
library(tidyverse)
#calculate score
company_info = company_info %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3))
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3))
library(readxl)
library(tidyverse)
options(digits = 2)
company_info = read_excel("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/company_info/company.xlsx")
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3))
library(readxl)
library(tidyverse)
options(digits = 2) # reduce decimal places
options(scipen=999) #avoid scientific notations (e.g. e+18)
company_info = read_excel("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/company_info/company.xlsx")
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3))
library(readxl)
library(tidyverse)
options(digits = 2) # reduce decimal places
options(scipen=999) #avoid scientific notations (e.g. e+18)
company_info = read_excel("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/company_info/company.xlsx")
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3))
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3), env_performance = totalGHG/total_assets)
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3), env_performance = (totalGHG/total_assets)*1000000)
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3), env_performance = (totalGHG/total_assets)*1000000000)
library(readxl)
library(tidyverse)
options(digits = 2) # reduce decimal places
options(scipen=999) #avoid scientific notations (e.g. e+18)
company_info = read_excel("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/company_info/company.xlsx")
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3), env_performance = (totalGHG/total_assets)*1000000000)
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3), env_performance = (totalGHG/total_assets)*10000000000)
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(totalGHG = sum(GHG1, GHG2, GHG3), env_performance = (totalGHG/total_assets)*1000000000000)
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(total_GHG = sum(GHG1, GHG2, GHG3), env_performance = (totalGHG/total_assets)*1000000000000)
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(total_GHG = sum(GHG1, GHG2, GHG3), env_performance = (total_GHG/total_assets)*1000000000000)
View(company_info)
rm(company_info)
library(readxl)
library(tidyverse)
options(digits = 2) # reduce decimal places
options(scipen=999) #avoid scientific notations (e.g. e+18)
company_info = read_excel("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/company_info/company.xlsx")
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(total_GHG = sum(GHG1, GHG2, GHG3), env_performance = (total_GHG/total_assets)*1000000000000)
View(company_info)
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(total_GHG = sum(GHG1, GHG2, GHG3), env_performance = (total_GHG/total_assets)*1000000000000,
env_revenue = (total_GHG/revenues)*1000000000000)
library(readxl)
library(tidyverse)
options(digits = 2) # reduce decimal places
options(scipen=999) #avoid scientific notations (e.g. e+18)
company_info = read_excel("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/company_info/company.xlsx")
#calculate score
company_info = company_info %>% group_by(company) %>% mutate(total_GHG = sum(GHG1, GHG2, GHG3), env_performance = (total_GHG/revenues)*1000000000000)
#replace with total assets as company size indicator: env_performance = (total_GHG/total_assets)*1000000000000
library(tidyverse)
library(tidyverse)
library(ggplot2)
library(GGally)
options(digits = 5) # reduce decimal places
options(scipen=999) #avoid scientific notations (e.g. e+18)
df_select = read_csv("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/DATA/df_select.csv")
df_select$company = as.factor(df_select$company)
df_select$sic = as.factor(df_select$sic)
df_select$industry1 = as.factor(df_select$industry1)
df_select$industry2 = as.factor(df_select$industry2)
df_select$env_claim_made = as.factor(df_select$env_claim_made)
df_select$max_morality = as.factor(df_select$max_morality)
df_select$topic = as.factor(df_select$topic)
df_select$topic_total_subset = as.factor(df_select$topic_total_subset)
#drop NAs of DV
df_select = df_select %>% drop_na(vice_sum)
df_select$virality_norm = normalize(df_select$virality)
#normalize metric IVs
normalize = function(x) {return ((x - min(x)) / (max(x) - min(x)))}
df_select$virality_norm = normalize(df_select$virality)
library(tidyverse)
library(ggplot2)
library(GGally)
options(digits = 5) # reduce decimal places
options(scipen=999) #avoid scientific notations (e.g. e+18)
df_select = read_csv("C:/Users/eva_s/OneDrive/MASTER/5. Semester_THESIS/Data Analytics/DATA/df_select.csv")
df_select$company = as.factor(df_select$company)
df_select$sic = as.factor(df_select$sic)
df_select$industry1 = as.factor(df_select$industry1)
df_select$industry2 = as.factor(df_select$industry2)
df_select$env_claim_made = as.factor(df_select$env_claim_made)
df_select$max_morality = as.factor(df_select$max_morality)
df_select$topic = as.factor(df_select$topic)
df_select$topic_total_subset = as.factor(df_select$topic_total_subset)
#drop NAs of DV
df_select = df_select %>% drop_na(vice_sum)
#select variables for analysis
df_analysis = df_select %>% select(vice_sum, employees, revenues, total_assets,env_performance, total_env_posts_perweek, ratio_env_nonenv, vice_sum, vice_virality)
summary(df_analysis)
library(corrplot)
library(RColorBrewer)
M  = cor(df_analysis)
corrplot(M, type="upper", order="hclust",
col=brewer.pal(n=8, name="RdYlBu"))
corrplot(M, type="upper", order="hclust",
col=brewer.pal(n=8, name="RdYlBu"))
M
M
